<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. Polynomial Model Method &#8212; GHOST Users&#39; Manual 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/todo-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Recipes for GHOST" href="recipes.html" />
    <link rel="prev" title="1. Overview of GHOST" href="instrument.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="recipes.html" title="3. Recipes for GHOST"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="instrument.html" title="1. Overview of GHOST"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GHOST Users&#39; Manual 0.9.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="polynomial-model-method">
<span id="ghost-spectrograph-model"></span><h1>2. Polynomial Model Method<a class="headerlink" href="#polynomial-model-method" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description-of-the-spectrograph-model-principle">
<h2>2.1. Description of the Spectrograph Model principle<a class="headerlink" href="#description-of-the-spectrograph-model-principle" title="Permalink to this headline">¶</a></h2>
<p>The principle employed in the development of this pipeline relies heavily
on a polynomial principle for all the modelling of the spectrograph&#8217;s
characteristics from the data. These include the location of the orders,
the wavelength scale and the reciprocal model that converts the sampled
slit from the slit viewer to its image on the spectrograph CCD.</p>
<p>The idea is that instead of a traditional empirical extraction where the
orders are &#8220;scanned&#8221; for their location and arc lines are detected blindly,
we form a model of the spectrograph and fit the parameters using the
flat fields and arcs to measure small changes in the spectrograph on a nightly basis.
Then, the extraction process becomes relatively trivial with knowledge
of where all the flux is and the wavelength scale is uniquely determined.
A simple advantage of this method is that the entire spectrograph is modelled as one,
instead of each individual order as a separate entity. Ultimately, measurements such as
radial velocity shifts can be determined using a single varying parameter,
as opposed to a combination of measured shifts in all orders.</p>
<p>The principle implemented is that of a sum of polynomials of polynomials.
This differs from an approach where each physical parameter of the spectrograph
is modelled individually and focusses on a series of coefficients that represent
various aspects of the CCD images. We thereby minimise the number of required
parameters that describe the data.</p>
</div>
<div class="section" id="mathematical-principle">
<h2>2.2. Mathematical principle<a class="headerlink" href="#mathematical-principle" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">polyfit</span></code> method uses files containing polynomial coefficients where each line
is the coefficients for the polynomials as a function of order, which are then combined
as a function of y position on the CCD chip, defined as the CCD pixel numbers in the
spectral direction.</p>
<p>For mathematical convininence and correspondence with a testable reference, the polynomials
are evaluated with respect to a reference order <img class="math" src="_images/math/050e729125cd4834fc336638165e6356b8fd03d1.png" alt="m_{\rm ref}"/>, defaulting as whatever
order number is in the middle of the range used for each arm, and as a function of the middle
pixel on the chip <img class="math" src="_images/math/cfa2af0012607f3eed596eb1c816e4652394880e.png" alt="y_{middle}"/>.</p>
<p>The functional form is:</p>
<div class="math">
<p><img src="_images/math/189942cae19262ee23f657375aecf23a49504efb.png" alt="F(p) = p_0(m) + p_1(m)*y' + p_2(m)*y'^2 + ..."/></p>
</div><p>with <img class="math" src="_images/math/9270e027ad321f912efa059fde7bf3a132a540f0.png" alt="y' = y - y_{middle}"/> , and:</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/2d4d2c33397b6a9911966b951333e86328d578eb.png" alt="p_0(m) = q_{00} + q_{01} * m' + q_{02} * m'^2 + ..."/></p>
</div></div></blockquote>
<p>with <img class="math" src="_images/math/bccc4a601551938d43c51bb14d02b72b105ca172.png" alt="m' = m_{\rm ref}/m - 1"/></p>
<p>In this functional form, <img class="math" src="_images/math/b69a066ee3c6db440c083a9cad71f15a34affae2.png" alt="F(p)"/> is whatever aspect we wish to model. In the specific
example of GHOST, it will be the x position (defined in the spatial direction) in the first
instance, but this same method is then used for the wavelength scale, and all three aspects
of the slit image on the chip (spatial direction magnification scale, spectral direction
magnification scale and rotation), all of which are expected to change as a function of order
and position along the order.</p>
<p>This means that the simplest wavelength scale spectrograph model should have:</p>
<blockquote>
<div><ul class="simple">
<li><img class="math" src="_images/math/1fc62c925863a232605a89fbff608dbe2117dbeb.png" alt="q_{00}"/> : central wavelength of order m_ref</li>
<li><img class="math" src="_images/math/eb721ba7096b6a677cd381b48848d65b00f33a1b.png" alt="q_{01}"/> : central wavelength of order m_ref</li>
<li><img class="math" src="_images/math/26289486513075a3f5da014c2b71f2fa7d218ea9.png" alt="q_{10}"/> : central_wavelength/R_pix, with R_pix the resolving power / pixel.</li>
<li><img class="math" src="_images/math/a239f66dd2ee37c4c707f404af9ee7f44cd39468.png" alt="q_{11}"/> : central_wavelength/R_pix, with R_pix the resolving power / pixel.</li>
</ul>
</div></blockquote>
<p>... with everything else approximately zero.</p>
<p>Please note that the order of polynomials is left undefined. The code that handles these
parameters is identical and left generalised since each aspect (x position, wavelength, etc)
may require a different number of variables to fully describe the problem.</p>
</div>
<div class="section" id="description-of-model-file-contents">
<h2>2.3. Description of model file contents<a class="headerlink" href="#description-of-model-file-contents" title="Permalink to this headline">¶</a></h2>
<p>In the case of the x position, using default file <cite>xmod.fits</cite>, the contents of this file are as
follows:</p>
<div class="math" id="equation-e:matrix">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-e:matrix" title="Permalink to this equation">¶</a></span><img src="_images/math/30bf48a029dad4a7786a77dd9a4ebdba8c98da6f.png" alt="X_{mod} = \left[\begin{array}{ccccc}
   q_{24} &amp; q_{23} &amp; q_{22} &amp; q_{21} &amp; q_{20} \\
   q_{14} &amp; q_{13} &amp; q_{12} &amp; q_{11} &amp; q_{10} \\
   q_{04} &amp; q_{03} &amp; q_{02} &amp; q_{01} &amp; q_{00} \\
\end{array}\right]"/></p>
</div><p>The non standard way to define the variables within the files and imported array is related
to the way numpy&#8217;s poly1d function takes inputs, with the highest order coefficient first.</p>
<p>In the case of x position, the coefficients represent:</p>
<blockquote>
<div><ul class="simple">
<li><img class="math" src="_images/math/1fc62c925863a232605a89fbff608dbe2117dbeb.png" alt="q_{00}"/> : x position of the middle of the reference order.</li>
<li><img class="math" src="_images/math/eb721ba7096b6a677cd381b48848d65b00f33a1b.png" alt="q_{01}"/> : linear term coefficient for order spacing</li>
<li><img class="math" src="_images/math/adb9f3a6fb76eff7887ca0817bfef5474cebda86.png" alt="q_{02}"/> : quadratic term coefficient for order spacing</li>
<li><img class="math" src="_images/math/26289486513075a3f5da014c2b71f2fa7d218ea9.png" alt="q_{10}"/> : common rotation term for all orders</li>
<li><img class="math" src="_images/math/a239f66dd2ee37c4c707f404af9ee7f44cd39468.png" alt="q_{11}"/> : linear term coefficient for order rotation</li>
<li><img class="math" src="_images/math/653f980eede01ddfcdb18f7f3d4dcecaa228d87d.png" alt="q_{12}"/> : quadratic term coefficient for order rotation</li>
<li><img class="math" src="_images/math/1768ab7ce10283ae65aa2410f7eda5681d306440.png" alt="q_{20}"/> : common curvature term for all orders</li>
<li><img class="math" src="_images/math/c8482f442165ac339d9c80f45a06e04b32d6b6a5.png" alt="q_{21}"/> : linear term coefficient for order curvature</li>
<li><img class="math" src="_images/math/b3cf6f7a53f5e53a319d76e19c076c65237e3c7f.png" alt="q_{22}"/> : quadratic term coefficient for order curvature</li>
</ul>
</div></blockquote>
<p>... with everything else approximately zero.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2. Polynomial Model Method</a><ul>
<li><a class="reference internal" href="#description-of-the-spectrograph-model-principle">2.1. Description of the Spectrograph Model principle</a></li>
<li><a class="reference internal" href="#mathematical-principle">2.2. Mathematical principle</a></li>
<li><a class="reference internal" href="#description-of-model-file-contents">2.3. Description of model file contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="instrument.html"
                        title="previous chapter">1. Overview of GHOST</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="recipes.html"
                        title="next chapter">3. Recipes for GHOST</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/model.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="recipes.html" title="3. Recipes for GHOST"
             >next</a> |</li>
        <li class="right" >
          <a href="instrument.html" title="1. Overview of GHOST"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GHOST Users&#39; Manual 0.9.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-17, The GHOST DRS Team &amp; Kathleen Labrie.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>